<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>架空サンプルゲーム - 統計 (Highcharts版)</title>
    <!-- Roboto Font Load -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Default is dark theme */
        html, body {
            overflow-x: hidden; /* Prevent horizontal scrolling on the root level */
        }
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #1a202c; /* Dark mode background color */
            color: #e2e8f0;
            box-sizing: border-box; /* Ensures padding and borders are included in the width */
        }
        .container {
            max-width: 1200px;
        }
        .card {
            background-color: #2d3748; /* Dark mode card background color */
        }
        input[type="date"] {
            background-color: #4a5568;
            border-color: #4a5568;
        }
        /* Light theme */
        @media (prefers-color-scheme: light) {
            body {
                background-color: #f7fafc; /* Light mode background color */
                color: #1a202c;
            }
            .card {
                background-color: #ffffff;
            }
            input[type="date"] {
                background-color: #edf2f7;
                border-color: #e2e8f0;
                color: #1a202c;
            }
            .light-mode-text-black {
                color: #1a202c;
            }
            .table-header {
                background-color: #e2e8f0;
                color: #1a202c;
            }
            .table-row-odd {
                background-color: #f7fafc;
            }
            .counter-text {
                color: #1a202c;
            }
        }
        /* For dark theme */
        @media (prefers-color-scheme: dark) {
            body {
                color: #f7fafc;
            }
            .table-header {
                background-color: #4a5568;
                color: #f7fafc;
            }
            .table-row-odd {
                background-color: #2d3748;
            }
            .counter-text {
                color: #ffffff;
            }
        }
        /* Highcharts Tooltip Style */
        .highcharts-tooltip span {
            font-family: 'Roboto', sans-serif;
            background-color: #1f2937;
            border: 1px solid #374151;
            padding: 8px;
            border-radius: 4px;
            color: #f9fafb;
        }

        @media (prefers-color-scheme: light) {
            .highcharts-tooltip span {
                background-color: #ffffff;
                border: 1px solid #e5e7eb;
                color: #111827;
            }
        }

        .active-btn {
            background-color: #3b82f6;
            color: white;
        }
        .inactive-btn {
            background-color: #4a5568;
            color: white;
        }
        .inactive-btn:hover {
            background-color: #6b7280;
        }
        .disabled-btn {
            opacity: 0.5;
            cursor: not-allowed;
            background-color: #4a5568 !important;
        }
        .disabled-btn:hover {
            background-color: #4a5568 !important;
        }
        .data-table-container {
            max-height: 500px;
            overflow-y: auto;
            overflow-x: auto; /* Added to allow horizontal scrolling for the table */
            -webkit-overflow-scrolling: touch;
        }
    </style>
</head>
<body>

<div class="container w-full mx-auto p-4 md:p-8">
    <!-- Header -->
    <header class="text-center mb-8">
        <h1 class="text-4xl md:text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-600">
            架空サンプルゲーム - 統計
        </h1>
        <p class="text-gray-400 mt-2">この統計はシミュレーションに基づく架空のデータであり、実際のものではありません。</p>
    </header>

    <!-- Game Info Section -->
    <div class="card p-6 rounded-xl shadow-lg mb-8">
        <h2 class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-blue-500 mb-4">
            ゲーム情報
        </h2>
        <div class="overflow-x-auto">
            <table class="w-full text-left table-auto">
                <tbody class="divide-y divide-gray-600/50">
                    <tr class="hover:bg-gray-700/50 light:hover:bg-gray-50">
                        <td class="p-3 font-semibold w-1/3 md:w-1/4">リリース日</td>
                        <td class="p-3">2026年1月1日 (2025年12月31日にベータ版リリース)</td>
                    </tr>
                    <tr class="hover:bg-gray-700/50 light:hover:bg-gray-50">
                        <td class="p-3 font-semibold">価格</td>
                        <td class="p-3">無料</td>
                    </tr>
                    <tr class="hover:bg-gray-700/50 light:hover:bg-gray-50">
                        <td class="p-3 font-semibold">アップデート</td>
                        <td class="p-3">原則、毎月1日に実施</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-gray-400 mt-4 text-sm">※このゲームおよび関連データはすべて架空のものです。</p>
    </div>


    <!-- Counters section -->
    <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 mb-8">
        <div class="card p-6 rounded-xl shadow-lg transform transition-transform duration-300 hover:scale-105">
            <div class="flex items-center text-xl font-bold text-blue-300">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-people mr-2" viewBox="0 0 16 16">
                    <path d="M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1zm-7.978-1L7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002-.014.002zM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4m3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0M6.936 9.28a6 6 0 0 0-1.23-.247A7 7 0 0 0 5 9c-4 0-5 3-5 4q0 1 1 1h4.216A2.24 2.24 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816M4.92 10A5.5 5.5 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0m3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4"/>
                </svg>
                <span>CCU</span>
            </div>
            <p id="ccu-counter" class="text-4xl font-extrabold mt-2 counter-text">0</p>
        </div>
        <div class="card p-6 rounded-xl shadow-lg transform transition-transform duration-300 hover:scale-105">
            <div class="flex items-center text-xl font-bold text-cyan-300">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-graph-up-arrow mr-2" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M0 0h1v15h15v1H0zm10 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V4.9l-3.613 4.417a.5.5 0 0 1-.74.037L7.06 6.767l-3.656 5.027a.5.5 0 0 1-.808-.588l4-5.5a.5.5 0 0 1 .758-.06l2.609 2.61L13.445 4H10.5a.5.5 0 0 1-.5-.5"/>
                </svg>
                <span>期間内平均CCU</span>
            </div>
            <p id="avg-ccu-counter" class="text-4xl font-extrabold mt-2 counter-text">0</p>
        </div>
        <div class="card p-6 rounded-xl shadow-lg transform transition-transform duration-300 hover:scale-105">
            <div class="flex items-center text-xl font-bold text-green-300">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-hand-thumbs-up mr-2" viewBox="0 0 16 16">
                    <path d="M8.864.046C7.908-.193 7.02.53 6.956 1.466c-.072 1.051-.23 2.016-.428 2.59-.125.36-.479 1.013-1.04 1.639-.557.623-1.282 1.178-2.131 1.41C2.685 7.288 2 7.87 2 8.72v4.001c0 .845.682 1.464 1.448 1.545 1.07.114 1.564.415 2.068.723l.048.03c.272.165.578.348.97.484.397.136.861.217 1.466.217h3.5c.937 0 1.599-.477 1.934-1.064a1.86 1.86 0 0 0 .254-.912c0-.152-.023-.312-.077-.464.201-.263.38-.578.488-.901.11-.33.172-.762.004-1.149.069-.13.12-.269.159-.403.077-.27.113-.568.113-.857 0-.288-.036-.585-.113-.856a2 2 0 0 0-.138-.362 1.9 1.9 0 0 0 .234-1.734c-.206-.592-.682-1.1-1.2-1.272-.847-.282-1.803-.276-2.516-.211a10 10 0 0 0-.443.05 9.4 9.4 0 0 0-.062-4.509A1.38 1.38 0 0 0 9.125.111zM11.5 14.721H8c-.51 0-.863-.069-1.14-.164-.281-.097-.506-.228-.776-.393l-.04-.024c-.555-.339-1.198-.731-2.49-.868-.333-.036-.554-.29-.554-.55V8.72c0-.254.226-.543.62-.65 1.095-.3 1.977-.996 2.614-1.708.635-.71 1.064-1.475 1.238-1.978.243-.7.407-1.768.482-2.85.025-.362.36-.594.667-.518l.262.066c.16.04.258.143.288.255a8.34 8.34 0 0 1-.145 4.725.5.5 0 0 0 .595.644l.003-.001.014-.003.058-.014a9 9 0 0 1 1.036-.157c.663-.06 1.457-.054 2.211.164.175.058.45.3.57.65.107.308.087.67-.266 1.022l-.353.353.353.354c.043.043.105.141.154.315.048.167.075.37.075.581 0 .212-.027.414-.075.582-.05.174-.111.272-.154.315l-.353.353.353.354c.047.047.109.177.005.488a2.2 2.2 0 0 1-.505.805l-.353.353.353.354c.006.005.041.05.041.17a.9.9 0 0 1-.121.416c-.165.288-.503.56-1.066.56z"/>
                </svg>
                <span>合計高評価数</span>
            </div>
            <p id="positive-counter" class="text-4xl font-extrabold mt-2 counter-text">0</p>
        </div>
        <div class="card p-6 rounded-xl shadow-lg transform transition-transform duration-300 hover:scale-105">
            <div class="flex items-center text-xl font-bold text-red-300">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-hand-thumbs-down mr-2" viewBox="0 0 16 16">
                    <path d="M8.864 15.674c-.956.24-1.843-.484-1.908-1.42-.072-1.05-.23-2.015-.428-2.59-.125-.36-.479-1.012-1.04-1.638-.557-.624-1.282-1.179-2.131-1.41C2.685 8.432 2 7.85 2 7V3c0-.845.682-1.464 1.448-1.546 1.07-.113 1.564-.415 2.068-.723l.048-.029c.272-.166.578-.349.97-.484C6.931.08 7.395 0 8 0h3.5c.937 0 1.599.478 1.934 1.064.164.287.254.607.254.913 0 .152-.023.312-.077-.464.201.262.38.577.488.9.11.33.172.762.004 1.15.069.13.12.268.159.403.077.27.113.567.113.856s-.036.586-.113.856c-.035.12-.08.244-.138.363.394.571.418 1.2.234 1.733-.206.592-.682-1.1-1.2 1.272-.847.283-1.803.276-2.516.211a10 10 0 0 1-.443-.05 9.36 9.36 0 0 1-.062 4.51c-.138.508-.55.848-1.012.964zM11.5 1H8c-.51 0-.863.068-1.14.163-.281.097-.506.229-.776.393l-.04.025c-.555.338-1.198.73-2.49.868-.333.035-.554.29-.554.55V7c0 .255.226.543.62.65 1.095.3 1.977.997 2.614 1.709.635-.71 1.064-1.475 1.238 1.977.243.7.407 1.768.482 2.85.025.362.36.595.667.518l.262-.065c.16-.04.258-.144.288-.255a8.34 8.34 0 0 0-.145-4.726.5.5 0 0 1 .595-.643h.003l.014.004.058.013a9 9 0 0 0 1.036.157c.663.06 1.457.054 2.11-.163.175-.059.45-.301.57-.651.107-.308.087-.67-.266-1.021L12.793 7l.353-.354c.043-.042.105-.14.154-.315.048-.167.075-.37.075-.581s-.027-.414-.075-.581c-.05-.174-.111-.273-.154-.315l-.353-.354.353-.354c.047-.047.109-.176.005-.488a2.2 2.2 0 0 0-.505-.804l-.353-.354.353-.354c.006-.005.041-.05.041-.17a.9.9 0 0 0-.121-.415C12.4 1.272 12.063 1 11.5 1"/>
                </svg>
                <span>合計低評価数</span>
            </div>
            <p id="negative-counter" class="text-4xl font-extrabold mt-2 counter-text">0</p>
        </div>
        <div class="card p-6 rounded-xl shadow-lg transform transition-transform duration-300 hover:scale-105">
             <div class="flex items-center text-xl font-bold text-yellow-300">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-percent mr-2" viewBox="0 0 16 16">
                    <path d="M13.442 2.558a.625.625 0 0 1 0 .884l-10 10a.625.625 0 1 1-.884-.884l10-10a.625.625 0 0 1 .884 0M4.5 6a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m0 1a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5m7 6a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m0 1a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5"/>
                </svg>
                <span>高評価率</span>
            </div>
            <p id="positive-ratio-counter" class="text-4xl font-extrabold mt-2 counter-text">0%</p>
        </div>
        <div class="card p-6 rounded-xl shadow-lg transform transition-transform duration-300 hover:scale-105">
            <div class="flex items-center text-xl font-bold text-indigo-300">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-trophy mr-2" viewBox="0 0 16 16">
                    <path d="M2.5.5A.5.5 0 0 1 3 0h10a.5.5 0 0 1 .5.5q0 .807-.034 1.536a3 3 0 1 1-1.133 5.89c-.79 1.865-1.878 2.777-2.833 3.011v2.173l1.425.356c.194.048.377.135.537.255L13.3 15.1a.5.5 0 0 1-.3.9H3a.5.5 0 0 1-.3-.9l1.838-1.379c.16-.12.343-.207.537-.255L6.5 13.11v-2.173c-.955-.234-2.043-1.146-2.833-3.012a3 3 0 1 1-1.132-5.89A33 33 0 0 1 2.5.5m.099 2.54a2 2 0 0 0 .72 3.935c-.333-1.05-.588-2.346-.72-3.935m10.083 3.935a2 2 0 0 0 .72-3.935c-.133 1.59-.388 2.885-.72 3.935M3.504 1q.01.775.056 1.469c.13 2.028.457 3.546.87 4.667C5.294 9.48 6.484 10 7 10a.5.5 0 0 1 .5.5v2.61a1 1 0 0 1-.757.97l-1.426.356a.5.5 0 0 0-.179.085L4.5 15h7l-.638-.479a.5.5 0 0 0-.18-.085l-1.425-.356a1 1 0 0 1-.757-.97V10.5A.5.5 0 0 1 9 10c.516 0 1.706-.52 2.57-2.864.413-1.12.74-2.64.87-4.667q.045-.694.056-1.469z"/>
                </svg>
                <span>期間内ピークCCU</span>
            </div>
            <p id="peak-ccu-counter" class="text-4xl font-extrabold mt-2 counter-text">0</p>
        </div>
    </div>

    <!-- Chart section -->
    <div class="card p-6 rounded-xl shadow-lg">
        <div class="flex flex-col space-y-4 mb-4">
            <div class="flex flex-wrap gap-x-6 gap-y-2 items-center">
                <div class="flex flex-wrap gap-2 items-center">
                    <p class="text-gray-300 light-mode-text-black">グラフ形式:</p>
                    <div id="chart-style-buttons">
                        <button data-style="line" class="px-4 py-2 chart-style-btn active-btn font-bold rounded-lg transition-colors">折れ線</button>
                        <button data-style="spline" class="px-4 py-2 chart-style-btn inactive-btn font-bold rounded-lg transition-colors">スプライン</button>
                    </div>
                </div>
                <div class="flex flex-wrap gap-2 items-center">
                    <p class="text-gray-300 light-mode-text-black">グラフの種類:</p>
                    <div id="chart-type-buttons">
                        <button data-chart="ccu" class="px-4 py-2 chart-type-btn active-btn font-bold rounded-lg transition-colors">CCU</button>
                        <button data-chart="avg-ccu" class="px-4 py-2 chart-type-btn inactive-btn font-bold rounded-lg transition-colors">平均CCU</button>
                        <button data-chart="cumulative-positive" class="px-4 py-2 chart-type-btn inactive-btn font-bold rounded-lg transition-colors">合計高評価</button>
                        <button data-chart="cumulative-negative" class="px-4 py-2 chart-type-btn inactive-btn font-bold rounded-lg transition-colors">合計低評価</button>
                        <button data-chart="ratio" class="px-4 py-2 chart-type-btn inactive-btn font-bold rounded-lg transition-colors">高評価率</button>
                    </div>
                </div>
            </div>
            <div class="flex flex-wrap gap-2 items-center">
                <p class="text-gray-300 light-mode-text-black">表示粒度:</p>
                <div id="granularity-buttons">
                    <button data-granularity="10m" class="px-4 py-2 granularity-btn inactive-btn font-bold rounded-lg transition-colors">10分</button>
                    <button data-granularity="30m" class="px-4 py-2 granularity-btn inactive-btn font-bold rounded-lg transition-colors">30分</button>
                    <button data-granularity="1h" class="px-4 py-2 granularity-btn inactive-btn font-bold rounded-lg transition-colors">1時間</button>
                    <button data-granularity="1d" class="px-4 py-2 granularity-btn active-btn font-bold rounded-lg transition-colors">1日</button>
                </div>
            </div>
            <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
                <div id="date-range-buttons" class="flex flex-wrap gap-2">
                    <button data-days="1" class="date-btn px-4 py-2 inactive-btn font-bold rounded-lg transition-colors">1日</button>
                    <button data-days="3" class="date-btn px-4 py-2 inactive-btn font-bold rounded-lg transition-colors">3日</button>
                    <button data-days="7" class="date-btn px-4 py-2 inactive-btn font-bold rounded-lg transition-colors">7日</button>
                    <button data-days="14" class="date-btn px-4 py-2 inactive-btn font-bold rounded-lg transition-colors">14日</button>
                    <button data-days="28" class="date-btn px-4 py-2 inactive-btn font-bold rounded-lg transition-colors">28日</button>
                    <button data-days="56" class="date-btn px-4 py-2 inactive-btn font-bold rounded-lg transition-colors">56日</button>
                    <button data-days="90" class="date-btn px-4 py-2 inactive-btn font-bold rounded-lg transition-colors">90日</button>
                    <button data-days="180" class="date-btn px-4 py-2 inactive-btn font-bold rounded-lg transition-colors">180日</button>
                    <button data-days="360" class="date-btn px-4 py-2 inactive-btn font-bold rounded-lg transition-colors">360日</button>
                    <button data-days="all" class="date-btn px-4 py-2 inactive-btn font-bold rounded-lg transition-colors">全期間</button>
                    <button data-days="custom" class="date-btn px-4 py-2 inactive-btn font-bold rounded-lg transition-colors">カスタム</button>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="flex flex-col items-start md:items-center md:flex-row md:space-x-2">
                        <div class="flex items-center space-x-2">
                            <label for="start-date-picker" class="text-gray-300 light-mode-text-black whitespace-nowrap">開始日:</label>
                            <input type="date" id="start-date-picker" class="bg-gray-700 border border-gray-600 text-white p-2 rounded-lg" disabled>
                        </div>
                        <div class="flex items-center space-x-2 mt-2 md:mt-0">
                            <label for="end-date-picker" class="text-gray-300 light-mode-text-black whitespace-nowrap">終了日:</label>
                            <input type="date" id="end-date-picker" class="bg-gray-700 border border-gray-600 text-white p-2 rounded-lg" disabled>
                        </div>
                    </div>
                    <button id="redraw-chart-btn" class="px-4 py-2 inactive-btn font-bold rounded-lg transition-colors flex-shrink-0">再描画</button>
                </div>
            </div>
             <div class="text-right mt-2">
                <span id="date-range-info" class="text-xs text-gray-400"></span>
            </div>
        </div>
        <div class="mt-4">
            <div id="highcharts-container"></div>
        </div>
    </div>

    <!-- Data Table Section -->
    <div class="card p-6 rounded-xl shadow-lg mt-8">
        <h2 class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-orange-500 mb-4">
            データ詳細
        </h2>
        <div class="data-table-container rounded-lg border border-gray-600">
            <table class="w-full text-left table-auto">
                <thead class="sticky top-0 z-10">
                    <tr class="table-header">
                        <th class="p-3 font-semibold text-sm rounded-tl-lg">日付 (UTC)</th>
                        <th class="p-3 font-semibold text-sm">CCU</th>
                        <th class="p-3 font-semibold text-sm">CCU (%)</th>
                        <th class="p-3 font-semibold text-sm">平均CCU</th>
                        <th class="p-3 font-semibold text-sm">平均CCU (%)</th>
                        <th class="p-3 font-semibold text-sm">合計高評価</th>
                        <th class="p-3 font-semibold text-sm">合計高評価 (%)</th>
                        <th class="p-3 font-semibold text-sm">合計低評価</th>
                        <th class="p-3 font-semibold text-sm">合計低評価 (%)</th>
                        <th class="p-3 font-semibold text-sm">高評価率</th>
                        <th class="p-3 font-semibold text-sm rounded-tr-lg">高評価率 (%)</th>
                    </tr>
                </thead>
                <tbody id="data-table-body">
                </tbody>
            </table>
        </div>
    </div>
</div>
<!-- Highcharts JS Libraries -->
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', () => {

        // --- NEW: Update Spike Pattern Data ---
        // This pattern is derived from the user-provided data.
        // It defines the CCU multiplier relative to a baseline, with time offsets from the peak.
        const UPDATE_SPIKE_PATTERN = [
            { offset: -432000000, multiplier: 1 }, { offset: -431400000, multiplier: 1.0100 }, { offset: -430800000, multiplier: 1.0258 }, { offset: -430200000, multiplier: 1.0336 }, { offset: -429600000, multiplier: 1.0444 }, { offset: -429000000, multiplier: 1.0441 }, { offset: -428400000, multiplier: 1.0508 }, { offset: -427800000, multiplier: 1.0516 }, { offset: -427200000, multiplier: 1.0681 }, { offset: -426600000, multiplier: 1.0862 }, { offset: -426000000, multiplier: 1.1417 }, { offset: -425400000, multiplier: 1.2086 }, { offset: -424800000, multiplier: 1.1484 }, { offset: -424200000, multiplier: 1.1110 },
            { offset: -423600000, multiplier: 1.1085 }, { offset: -423000000, multiplier: 1.1136 }, { offset: -422400000, multiplier: 1.1360 }, { offset: -421800000, multiplier: 1.1189 }, { offset: -421200000, multiplier: 1.1291 }, { offset: -420600000, multiplier: 1.1570 }, { offset: -420000000, multiplier: 1.2074 }, { offset: -419400000, multiplier: 1.2825 }, { offset: -418800000, multiplier: 1.4318 }, { offset: -418200000, multiplier: 1.2882 }, { offset: -417600000, multiplier: 1.2404 }, { offset: -417000000, multiplier: 1.2284 }, { offset: -416400000, multiplier: 1.2424 }, { offset: -415800000, multiplier: 1.2852 },
            { offset: -415200000, multiplier: 1.4069 }, { offset: -414600000, multiplier: 1.4853 }, { offset: -414000000, multiplier: 1.4156 }, { offset: -413400000, multiplier: 1.4153 }, { offset: -412800000, multiplier: 1.5186 }, { offset: -412200000, multiplier: 1.7445 }, { offset: -411600000, multiplier: 2.2415 }, { offset: -411000000, multiplier: 1.7736 }, { offset: -410400000, multiplier: 1.5667 }, { offset: -409800000, multiplier: 1.4621 }, { offset: -409200000, multiplier: 1.3977 }, { offset: -408600000, multiplier: 1.3676 }, { offset: -408000000, multiplier: 1.3736 }, { offset: -407400000, multiplier: 1.3421 },
            { offset: -406800000, multiplier: 1.3389 }, { offset: -406200000, multiplier: 1.3535 }, { offset: -405600000, multiplier: 1.4342 }, { offset: -405000000, multiplier: 1.5983 }, { offset: -404400000, multiplier: 2.0110 }, { offset: -403800000, multiplier: 1.8538 }, { offset: -403200000, multiplier: 1.5773 }, { offset: -402600000, multiplier: 1.4354 }, { offset: -402000000, multiplier: 1.3710 }, { offset: -401400000, multiplier: 1.3441 }, { offset: -400800000, multiplier: 1.3499 }, { offset: -400200000, multiplier: 1.3077 }, { offset: -399600000, multiplier: 1.2983 }, { offset: -399000000, multiplier: 1.2887 },
            { offset: -398400000, multiplier: 1.2929 }, { offset: -397800000, multiplier: 1.2912 }, { offset: -397200000, multiplier: 1.2938 }, { offset: -396600000, multiplier: 1.2964 }, { offset: -396000000, multiplier: 1.3030 }, { offset: -395400000, multiplier: 1.3109 }, { offset: -394800000, multiplier: 1.3506 }, { offset: -394200000, multiplier: 1.3706 }, { offset: -393600000, multiplier: 1.4248 }, { offset: -393000000, multiplier: 1.4989 }, { offset: -392400000, multiplier: 1.5905 }, { offset: -391800000, multiplier: 1.4525 }, { offset: -391200000, multiplier: 1.4182 }, { offset: -390600000, multiplier: 1.4153 },
            { offset: -390000000, multiplier: 1.4576 }, { offset: -389400000, multiplier: 1.5128 }, { offset: -388800000, multiplier: 1.4426 }, { offset: -388200000, multiplier: 1.4042 }, { offset: -387600000, multiplier: 1.3927 }, { offset: -387000000, multiplier: 1.3900 }, { offset: -386400000, multiplier: 1.4104 }, { offset: -385800000, multiplier: 1.4762 }, { offset: -385200000, multiplier: 1.4130 }, { offset: -384600000, multiplier: 1.3561 }, { offset: -384000000, multiplier: 1.3365 }, { offset: -383400000, multiplier: 1.3158 }, { offset: -382800000, multiplier: 1.3248 }, { offset: -382200000, multiplier: 1.3681 },
            { offset: -381600000, multiplier: 1.2945 }, { offset: -381000000, multiplier: 1.2289 }, { offset: -380400000, multiplier: 1.1936 }, { offset: -379800000, multiplier: 1.1707 }, { offset: -379200000, multiplier: 1.1682 }, { offset: -378600000, multiplier: 1.2005 }, { offset: -378000000, multiplier: 1.1301 }, { offset: -377400000, multiplier: 1.0681 }, { offset: -376800000, multiplier: 1.0385 }, { offset: -376200000, multiplier: 1.0125 }, { offset: -375600000, multiplier: 1.0095 }, { offset: -375000000, multiplier: 1.0459 }, { offset: -374400000, multiplier: 0.9900 }, { offset: -373800000, multiplier: 0.9363 },
            { offset: -373200000, multiplier: 0.9163 }, { offset: -372600000, multiplier: 0.9074 }, { offset: -372000000, multiplier: 0.9227 }, { offset: -371400000, multiplier: 0.9633 }, { offset: -370800000, multiplier: 0.9111 }, { offset: -370200000, multiplier: 0.8738 }, { offset: -369600000, multiplier: 0.8655 }, { offset: -369000000, multiplier: 0.8656 }, { offset: -368400000, multiplier: 0.8976 }, { offset: -367800000, multiplier: 0.9536 }, { offset: -367200000, multiplier: 0.9118 }, { offset: -366600000, multiplier: 0.8677 }, { offset: -366000000, multiplier: 0.8545 }, { offset: -365400000, multiplier: 0.8521 },
            { offset: -364800000, multiplier: 0.8735 }, { offset: -364200000, multiplier: 0.9257 }, { offset: -363600000, multiplier: 0.8776 }, { offset: -363000000, multiplier: 0.8399 }, { offset: -362400000, multiplier: 0.8301 }, { offset: -361800000, multiplier: 0.8289 }, { offset: -361200000, multiplier: 0.8488 }, { offset: -360600000, multiplier: 0.8939 }, { offset: -36000000, multiplier: 0.8504 }, { offset: -359400000, multiplier: 0.8234 }, { offset: -358800000, multiplier: 0.8204 }, { offset: -358200000, multiplier: 0.8279 }, { offset: -357600000, multiplier: 0.8587 }, { offset: -357000000, multiplier: 0.9160 },
            { offset: -356400000, multiplier: 0.8835 }, { offset: -355800000, multiplier: 0.8595 }, { offset: -355200000, multiplier: 0.8639 }, { offset: -354600000, multiplier: 0.8805 }, { offset: -354000000, multiplier: 0.9221 }, { offset: -353400000, multiplier: 0.9920 }, { offset: -352800000, multiplier: 0.9725 }, { offset: -352200000, multiplier: 0.9646 }, { offset: -351600000, multiplier: 0.9818 }, { offset: -351000000, multiplier: 1.0169 }, { offset: -350400000, multiplier: 1.0765 }, { offset: -349800000, multiplier: 1.1802 }, { offset: -349200000, multiplier: 1.1645 }, { offset: -348600000, multiplier: 1.1568 },
            { offset: -348000000, multiplier: 1.1817 }, { offset: -347400000, multiplier: 1.2154 }, { offset: -346800000, multiplier: 1.2762 }, { offset: -346200000, multiplier: 1.2597 }, { offset: -345600000, multiplier: 1.2088 }, { offset: -345000000, multiplier: 1.1720 }, { offset: -344400000, multiplier: 1.1800 }, { offset: -343800000, multiplier: 1.2104 }, { offset: -343200000, multiplier: 1.2558 }, { offset: -342600000, multiplier: 1.6069 }, { offset: -342000000, multiplier: 1.5574 }, { offset: -341400000, multiplier: 1.8864 }, { offset: -340800000, multiplier: 1.8657 }, { offset: -340200000, multiplier: 1.8167 },
            { offset: -339600000, multiplier: 1.8488 }, { offset: -339000000, multiplier: 1.9089 }, { offset: -338400000, multiplier: 1.8259 }, { offset: -337800000, multiplier: 1.7705 }, { offset: -337200000, multiplier: 1.7785 }, { offset: -336600000, multiplier: 1.8033 }, { offset: -336000000, multiplier: 1.9230 }, { offset: -335400000, multiplier: 2.0844 }, { offset: -334800000, multiplier: 2.0533 }, { offset: -334200000, multiplier: 2.0189 }, { offset: -333600000, multiplier: 2.0297 }, { offset: -333000000, multiplier: 2.0552 }, { offset: -332400000, multiplier: 2.1559 }, { offset: -331800000, multiplier: 2.4037 },
            { offset: -331200000, multiplier: 2.4093 }, { offset: -330600000, multiplier: 2.4059 }, { offset: -330000000, multiplier: 2.4664 }, { offset: -329400000, multiplier: 2.6019 }, { offset: -328800000, multiplier: 3.0031 }, { offset: -328200000, multiplier: 4.4109 }, { offset: -327600000, multiplier: 5.0384 }, { offset: -327000000, multiplier: 6.3308 }, { offset: -326400000, multiplier: 8.1853 }, { offset: -325800000, multiplier: 12.3813 }, { offset: -325200000, multiplier: 19.5821 }, { offset: -324600000, multiplier: 20.3709 }, { offset: -324000000, multiplier: 20.8565 }, { offset: -323400000, multiplier: 20.6764 },
            { offset: -322800000, multiplier: 19.6533 }, { offset: -322200000, multiplier: 14.2857 }, { offset: -321600000, multiplier: 7.0425 }, { offset: -321000000, multiplier: 4.6391 }, { offset: -320400000, multiplier: 3.4050 }, { offset: -319800000, multiplier: 2.7840 }, { offset: -319200000, multiplier: 2.3931 }, { offset: -318600000, multiplier: 2.2356 }, { offset: -318000000, multiplier: 2.1771 }, { offset: -317400000, multiplier: 2.1032 }, { offset: -316800000, multiplier: 1.9659 }, { offset: -316200000, multiplier: 1.8789 }, { offset: -315600000, multiplier: 1.8374 }, { offset: -315000000, multiplier: 1.8057 },
            { offset: -314400000, multiplier: 1.8164 }, { offset: -313800000, multiplier: 1.8343 }, { offset: -313200000, multiplier: 1.7731 }, { offset: -312600000, multiplier: 1.7455 }, { offset: -312000000, multiplier: 1.7322 }, { offset: -311400000, multiplier: 1.7213 }, { offset: -310800000, multiplier: 1.7467 }, { offset: -309600000, multiplier: 1.7061 }, { offset: -309000000, multiplier: 1.7220 }, { offset: -308400000, multiplier: 1.6997 }, { offset: -307800000, multiplier: 1.6984 }, { offset: -307200000, multiplier: 1.7000 }, { offset: -306600000, multiplier: 1.7251 }, { offset: -306000000, multiplier: 1.7832 },
            { offset: -305400000, multiplier: 1.7492 }, { offset: -304800000, multiplier: 1.7188 }, { offset: -304200000, multiplier: 1.7079 }, { offset: -303600000, multiplier: 1.7012 }, { offset: -303000000, multiplier: 1.7242 }, { offset: -302400000, multiplier: 1.7724 }, { offset: -301800000, multiplier: 1.7356 }, { offset: -301200000, multiplier: 1.7002 }, { offset: -300600000, multiplier: 1.6920 }, { offset: -300000000, multiplier: 1.6869 }, { offset: -299400000, multiplier: 1.6971 }, { offset: -298800000, multiplier: 1.7359 }, { offset: -298200000, multiplier: 1.6826 }, { offset: -297600000, multiplier: 1.6369 },
            { offset: -297000000, multiplier: 1.6131 }, { offset: -296400000, multiplier: 1.5912 }, { offset: -295800000, multiplier: 1.5927 }, { offset: -295200000, multiplier: 1.6065 }, { offset: -294600000, multiplier: 1.5375 }, { offset: -294000000, multiplier: 1.4819 }, { offset: -293400000, multiplier: 1.4466 }, { offset: -292800000, multiplier: 1.4042 }, { offset: -292200000, multiplier: 1.3855 }, { offset: -291600000, multiplier: 1.3907 }, { offset: -291000000, multiplier: 1.4271 }, { offset: -290400000, multiplier: 1.3793 }, { offset: -289800000, multiplier: 1.3395 }, { offset: -289200000, multiplier: 1.3290 },
            { offset: -288600000, multiplier: 1.3209 }, { offset: -288000000, multiplier: 1.3315 }, { offset: -287400000, multiplier: 1.3744 }, { offset: -286800000, multiplier: 1.3422 }, { offset: -286200000, multiplier: 1.3005 }, { offset: -285600000, multiplier: 1.2893 }, { offset: -285000000, multiplier: 1.2830 }, { offset: -284400000, multiplier: 1.2884 }, { offset: -283800000, multiplier: 1.2408 }, { offset: -283200000, multiplier: 1.2215 }, { offset: -282600000, multiplier: 1.2198 }, { offset: -282000000, multiplier: 1.2057 }, { offset: -281400000, multiplier: 1.1932 }, { offset: -280800000, multiplier: 1.1816 },
            { offset: -279600000, multiplier: 1.1323 }, { offset: -279000000, multiplier: 1.1214 }, { offset: -278400000, multiplier: 1.1200 }, { offset: -277800000, multiplier: 1.1073 }, { offset: -277200000, multiplier: 1.1000 }, { offset: -276600000, multiplier: 1.0652 }, { offset: -276000000, multiplier: 1.0381 }, { offset: -275400000, multiplier: 1.0298 }, { offset: -274800000, multiplier: 1.0270 }, { offset: -274200000, multiplier: 1.0494 }, { offset: -273600000, multiplier: 1.0722 }, { offset: -273000000, multiplier: 1.0507 }, { offset: -272400000, multiplier: 1.0258 },
            { offset: -271800000, multiplier: 1.0250 }, { offset: -271200000, multiplier: 1.0221 }, { offset: -270600000, multiplier: 1.0372 }, { offset: -270000000, multiplier: 1.0718 }, { offset: -269400000, multiplier: 1.0392 }, { offset: -268800000, multiplier: 1.0287 }, { offset: -268200000, multiplier: 1.0270 }, { offset: -267600000, multiplier: 1.0372 }, { offset: -267000000, multiplier: 1.0706 }, { offset: -266400000, multiplier: 1.1120 }, { offset: -265800000, multiplier: 1.0944 }, { offset: -265200000, multiplier: 1.0897 }, { offset: -264600000, multiplier: 1.1048 }, { offset: -264000000, multiplier: 1.1277 },
            { offset: -263400000, multiplier: 1.1693 }, { offset: -262800000, multiplier: 1.2280 }, { offset: -262200000, multiplier: 1.2170 }, { offset: -261600000, multiplier: 1.2230 }, { offset: -261000000, multiplier: 1.2474 }, { offset: -260400000, multiplier: 1.2775 }, { offset: -259800000, multiplier: 1.3337 }, { offset: -259200000, multiplier: 1.3960 }, { offset: -258600000, multiplier: 1.3809 }, { offset: -258000000, multiplier: 1.3820 }, { offset: -257400000, multiplier: 1.4051 }, { offset: -256800000, multiplier: 1.4335 }, { offset: -256200000, multiplier: 1.4967 }, { offset: -255600000, multiplier: 1.5560 },
            { offset: -255000000, multiplier: 1.5308 }, { offset: -254400000, multiplier: 1.5212 }, { offset: -253800000, multiplier: 1.5372 }, { offset: -253200000, multiplier: 1.5598 }, { offset: -252600000, multiplier: 1.6215 }, { offset: -252000000, multiplier: 1.6526 }, { offset: -251400000, multiplier: 1.6417 }, { offset: -250800000, multiplier: 1.6284 }, { offset: -250200000, multiplier: 1.6380 }, { offset: -249600000, multiplier: 1.6558 }, { offset: -249000000, multiplier: 1.7088 }, { offset: -248400000, multiplier: 1.7711 }, { offset: -247800000, multiplier: 1.7322 }, { offset: -247200000, multiplier: 1.7169 },
            { offset: -246600000, multiplier: 1.7203 }, { offset: -246000000, multiplier: 1.7366 }, { offset: -245400000, multiplier: 1.8000 }, { offset: -244800000, multiplier: 1.8342 }, { offset: -244200000, multiplier: 1.7756 }, { offset: -243600000, multiplier: 1.7525 }, { offset: -243000000, multiplier: 1.7615 }, { offset: -242400000, multiplier: 1.7788 }, { offset: -241800000, multiplier: 1.8562 }, { offset: -241200000, multiplier: 1.9122 }, { offset: -240600000, multiplier: 1.8821 }, { offset: -240000000, multiplier: 1.9260 }, { offset: -239400000, multiplier: 2.0744 }, { offset: -238800000, multiplier: 2.3054 },
            { offset: -238200000, multiplier: 2.8468 }, { offset: -237600000, multiplier: 2.5728 }, { offset: -237000000, multiplier: 2.0646 }, { offset: -236400000, multiplier: 1.8769 }, { offset: -235800000, multiplier: 1.7409 }, { offset: -235200000, multiplier: 1.6845 }, { offset: -234600000, multiplier: 1.6869 }, { offset: -234000000, multiplier: 1.6859 }, { offset: -233400000, multiplier: 1.5912 }, { offset: -232800000, multiplier: 1.5501 }, { offset: -232200000, multiplier: 1.5576 }, { offset: -231600000, multiplier: 1.6223 }, { offset: -231000000, multiplier: 1.8000 }, { offset: -230400000, multiplier: 1.7522 },
            { offset: -229800000, multiplier: 1.5764 }, { offset: -229200000, multiplier: 1.4549 }, { offset: -228600000, multiplier: 1.4042 }, { offset: -228000000, multiplier: 1.3855 }, { offset: -227400000, multiplier: 1.3907 }, { offset: -226800000, multiplier: 1.4271 }, { offset: -226200000, multiplier: 1.3793 }, { offset: -225600000, multiplier: 1.3395 }, { offset: -225000000, multiplier: 1.3290 }, { offset: -224400000, multiplier: 1.3209 }, { offset: -223800000, multiplier: 1.3315 }, { offset: -223200000, multiplier: 1.3744 }, { offset: -222600000, multiplier: 1.3422 }, { offset: -222000000, multiplier: 1.3005 },
            { offset: -221400000, multiplier: 1.2893 }, { offset: -220800000, multiplier: 1.2830 }, { offset: -220200000, multiplier: 1.2884 }, { offset: -219600000, multiplier: 1.2408 }, { offset: -219000000, multiplier: 1.2215 }, { offset: -218400000, multiplier: 1.2198 }, { offset: -217800000, multiplier: 1.2057 }, { offset: -217200000, multiplier: 1.1932 }, { offset: -216600000, multiplier: 1.1816 }, { offset: -216000000, multiplier: 1.1572 }, { offset: -215400000, multiplier: 1.1300 }, { offset: -214800000, multiplier: 1.1164 }, { offset: -214200000, multiplier: 1.0955 }, { offset: -213600000, multiplier: 1.0747 },
            { offset: -213000000, multiplier: 1.0530 }, { offset: -212400000, multiplier: 1.0433 }, { offset: -211800000, multiplier: 1.0800 }, { offset: -211200000, multiplier: 1.0102 }, { offset: -210600000, multiplier: 0.9479 }, { offset: -210000000, multiplier: 0.9110 }, { offset: -209400000, multiplier: 0.8816 }, { offset: -208800000, multiplier: 0.8521 }, { offset: -208200000, multiplier: 0.8159 }, { offset: -207600000, multiplier: 0.7981 }, { offset: -207000000, multiplier: 0.7764 }, { offset: -206400000, multiplier: 0.7550 }, { offset: -205800000, multiplier: 0.7356 }, { offset: -205200000, multiplier: 0.7162 },
            { offset: -204600000, multiplier: 0.6857 }, { offset: -204000000, multiplier: 0.6841 }, { offset: -203400000, multiplier: 0.6760 }, { offset: -202800000, multiplier: 0.6695 }, { offset: -202200000, multiplier: 0.6622 }, { offset: -201600000, multiplier: 0.6666 }, { offset: -201000000, multiplier: 0.6784 }, { offset: -200400000, multiplier: 0.6484 }, { offset: -199800000, multiplier: 0.6215 }, { offset: -199200000, multiplier: 0.6045 }, { offset: -198600000, multiplier: 0.5967 }, { offset: -198000000, multiplier: 0.5922 }, { offset: -197400000, multiplier: 0.5782 }, { offset: -196800000, multiplier: 0.5877 },
            { offset: -196200000, multiplier: 0.5898 }, { offset: -195600000, multiplier: 0.5953 }, { offset: -195000000, multiplier: 0.5977 }, { offset: -194400000, multiplier: 0.5977 }, { offset: -193800000, multiplier: 0.5858 }, { offset: -193200000, multiplier: 0.5942 }, { offset: -192600000, multiplier: 0.6019 }, { offset: -192000000, multiplier: 0.6128 }, { offset: -191400000, multiplier: 0.6267 }, { offset: -190800000, multiplier: 0.6543 }, { offset: -190200000, multiplier: 0.6963 }, { offset: -189600000, multiplier: 0.6948 }, { offset: -189000000, multiplier: 0.6932 }, { offset: -188400000, multiplier: 0.7022 },
            { offset: -187800000, multiplier: 0.7138 }, { offset: -187200000, multiplier: 0.7173 }, { offset: -186600000, multiplier: 0.7243 }, { offset: -186000000, multiplier: 0.7389 }, { offset: -185400000, multiplier: 0.7482 }, { offset: -184800000, multiplier: 0.7566 }, { offset: -184200000, multiplier: 0.7676 }, { offset: -183600000, multiplier: 0.7726 }, { offset: -183000000, multiplier: 0.7778 }, { offset: -182400000, multiplier: 0.7925 }, { offset: -181800000, multiplier: 0.8123 }, { offset: -181200000, multiplier: 0.8291 }, { offset: -180600000, multiplier: 0.8519 }, { offset: -180000000, multiplier: 0.8921 },
            { offset: -179400000, multiplier: 0.9489 }, { offset: -178800000, multiplier: 0.9361 }, { offset: -178200000, multiplier: 0.9275 }, { offset: -177600000, multiplier: 0.9414 }, { offset: -177000000, multiplier: 0.9570 }, { offset: -176400000, multiplier: 0.9707 }, { offset: -175800000, multiplier: 0.9824 }, { offset: -175200000, multiplier: 1.0086 }, { offset: -174600000, multiplier: 1.0236 }, { offset: -174000000, multiplier: 1.0361 }, { offset: -173400000, multiplier: 1.0453 }, { offset: -172800000, multiplier: 1.0500 }, { offset: -172200000, multiplier: 1.0542 }, { offset: -171600000, multiplier: 1.0655 },
            { offset: -171000000, multiplier: 1.0733 }, { offset: -170400000, multiplier: 1.0871 }, { offset: -169800000, multiplier: 1.1000 }, { offset: -169200000, multiplier: 1.1309 }, { offset: -168600000, multiplier: 1.1813 }, { offset: -168000000, multiplier: 1.1458 }, { offset: -167400000, multiplier: 1.1216 }, { offset: -166800000, multiplier: 1.1244 }, { offset: -166200000, multiplier: 1.1308 }, { offset: -165600000, multiplier: 1.1240 }, { offset: -16500000, multiplier: 1.1200 }, { offset: -164400000, multiplier: 1.1322 }, { offset: -163800000, multiplier: 1.1329 }, { offset: -163200000, multiplier: 1.1358 },
            { offset: -162600000, multiplier: 1.1402 }, { offset: -162000000, multiplier: 1.1345 }, { offset: -161400000, multiplier: 1.1303 }, { offset: -160800000, multiplier: 1.1400 }, { offset: -160200000, multiplier: 1.1400 }, { offset: -159600000, multiplier: 1.1521 }, { offset: -159000000, multiplier: 1.1628 }, { offset: -158400000, multiplier: 1.1942 }, { offset: -157800000, multiplier: 1.2507 }, { offset: -157200000, multiplier: 1.2065 }, { offset: -156600000, multiplier: 1.1581 }, { offset: -156000000, multiplier: 1.1378 }, { offset: -155400000, multiplier: 1.1224 }, { offset: -154800000, multiplier: 1.1073 },
            { offset: -154200000, multiplier: 1.0832 }, { offset: -153600000, multiplier: 1.0715 }, { offset: -153000000, multiplier: 1.0598 }, { offset: -152400000, multiplier: 1.0400 }, { offset: -151800000, multiplier: 1.0179 }, { offset: -151200000, multiplier: 0.9947 }, { offset: -150600000, multiplier: 0.9587 }, { offset: -150000000, multiplier: 0.9332 }, { offset: -149400000, multiplier: 0.9110 }, { offset: -148800000, multiplier: 0.8935 }, { offset: -148200000, multiplier: 0.8772 }, { offset: -147600000, multiplier: 0.8633 }, { offset: -147000000, multiplier: 0.8637 }, { offset: -146400000, multiplier: 0.8106 },
            { offset: -145800000, multiplier: 0.7591 }, { offset: -145200000, multiplier: 0.7231 }, { offset: -144600000, multiplier: 0.6950 }, { offset: -144000000, multiplier: 0.6666 }, { offset: -143400000, multiplier: 0.6316 }, { offset: -142800000, multiplier: 0.6159 }, { offset: -142200000, multiplier: 0.5972 }, { offset: -141600000, multiplier: 0.5772 }, { offset: -141000000, multiplier: 0.5609 }, { offset: -140400000, multiplier: 0.5445 }, { offset: -139800000, multiplier: 0.5237 }, { offset: -139200000, multiplier: 0.5214 }, { offset: -138600000, multiplier: 0.5151 }, { offset: -138000000, multiplier: 0.5096 },
            { offset: -137400000, multiplier: 0.5108 }, { offset: -136800000, multiplier: 0.5145 }, { offset: -136200000, multiplier: 0.5251 }, { offset: -135600000, multiplier: 0.4973 }, { offset: -135000000, multiplier: 0.4774 }, { offset: -134400000, multiplier: 0.4667 }, { offset: -133800000, multiplier: 0.4648 }, { offset: -133200000, multiplier: 0.4619 }, { offset: -132600000, multiplier: 0.4575 }, { offset: -132000000, multiplier: 0.4636 }, { offset: -131400000, multiplier: 0.4652 }, { offset: -130800000, multiplier: 0.4673 }, { offset: -130200000, multiplier: 0.4683 }, { offset: -129600000, multiplier: 0.4695 },
            { offset: -129000000, multiplier: 0.4724 }, { offset: -128400000, multiplier: 0.4820 }, { offset: -127800000, multiplier: 0.4907 }, { offset: -127200000, multiplier: 0.4998 }, { offset: -126600000, multiplier: 0.5085 }, { offset: -126000000, multiplier: 0.5242 }, { offset: -125400000, multiplier: 0.5425 }, { offset: -124800000, multiplier: 0.5701 }, { offset: -124200000, multiplier: 0.5679 }, { offset: -123600000, multiplier: 0.5607 }, { offset: -123000000, multiplier: 0.5660 }, { offset: -122400000, multiplier: 0.5759 }, { offset: -121800000, multiplier: 0.5813 }, { offset: -121200000, multiplier: 0.5892 },
            { offset: -120600000, multiplier: 0.6092 }, { offset: -120000000, multiplier: 0.6200 }, { offset: -119400000, multiplier: 0.6382 }, { offset: -118800000, multiplier: 0.6569 }, { offset: -118200000, multiplier: 0.6672 }, { offset: -117600000, multiplier: 0.6793 }, { offset: -117000000, multiplier: 0.6999 }, { offset: -116400000, multiplier: 0.7156 }, { offset: -115800000, multiplier: 0.7357 }, { offset: -115200000, multiplier: 0.7580 }, { offset: -114600000, multiplier: 0.7949 }, { offset: -114000000, multiplier: 0.8522 }, { offset: -113400000, multiplier: 0.8338 }, { offset: -112800000, multiplier: 0.8207 },
            { offset: -112200000, multiplier: 0.8274 }, { offset: -111600000, multiplier: 0.8355 }, { offset: -111000000, multiplier: 0.8443 }, { offset: -110400000, multiplier: 0.8464 }, { offset: -109800000, multiplier: 0.8600 }, { offset: -109200000, multiplier: 0.8715 }, { offset: -108600000, multiplier: 0.8778 }, { offset: -108000000, multiplier: 0.8801 }, { offset: -107400000, multiplier: 0.8844 }, { offset: -106800000, multiplier: 0.8752 }, { offset: -106200000, multiplier: 0.8791 }, { offset: -105600000, multiplier: 0.8803 }, { offset: -105000000, multiplier: 0.8834 }, { offset: -104400000, multiplier: 0.8981 },
            { offset: -103800000, multiplier: 0.9451 }, { offset: -103200000, multiplier: 0.9870 }, { offset: -102600000, multiplier: 0.9320 }, { offset: -102000000, multiplier: 0.9144 }, { offset: -101400000, multiplier: 0.9009 }, { offset: -100800000, multiplier: 0.8956 }, { offset: -100200000, multiplier: 0.8888 }, { offset: -99600000, multiplier: 0.8767 }, { offset: -990000000, multiplier: 0.8727 }, { offset: -98400000, multiplier: 0.8655 }, { offset: -97800000, multiplier: 0.8525 }, { offset: -97200000, multiplier: 0.8406 }, { offset: -96600000, multiplier: 0.8373 }, { offset: -960000000, multiplier: 0.8222 },
            { offset: -95400000, multiplier: 0.8039 }, { offset: -94800000, multiplier: 0.7925 }, { offset: -94200000, multiplier: 0.7735 }, { offset: -93600000, multiplier: 0.7588 }, { offset: -93000000, multiplier: 0.7424 }, { offset: -92400000, multiplier: 0.7303 }, { offset: -91800000, multiplier: 0.7288 }, { offset: -91200000, multiplier: 0.6917 }, { offset: -90600000, multiplier: 0.6559 }, { offset: -90000000, multiplier: 0.6277 }, { offset: -89400000, multiplier: 0.6053 }, { offset: -88800000, multiplier: 0.5843 }, { offset: -88200000, multiplier: 0.5661 }, { offset: -87600000, multiplier: 0.5516 },
            { offset: -87000000, multiplier: 0.5348 }, { offset: -86400000, multiplier: 0.5168 }, { offset: -85800000, multiplier: 0.5011 }, { offset: -85200000, multiplier: 0.4902 }, { offset: -84600000, multiplier: 0.4852 }, { offset: -84000000, multiplier: 0.4849 }, { offset: -83400000, multiplier: 0.4820 }, { offset: -82800000, multiplier: 0.4795 }, { offset: -82200000, multiplier: 0.4718 }, { offset: -81600000, multiplier: 0.4674 }, { offset: -81000000, multiplier: 0.4688 }, { offset: -80400000, multiplier: 0.4745 }, { offset: -79800000, multiplier: 0.4740 }, { offset: -79200000, multiplier: 0.4658 },
            { offset: -78600000, multiplier: 0.4578 }, { offset: -78000000, multiplier: 0.4526 }, { offset: -77400000, multiplier: 0.4496 }, { offset: -76800000, multiplier: 0.4503 }, { offset: -76200000, multiplier: 0.4522 }, { offset: -75600000, multiplier: 0.4554 }, { offset: -75000000, multiplier: 0.4566 }, { offset: -74400000, multiplier: 0.4571 }, { offset: -73800000, multiplier: 0.4580 }, { offset: -73200000, multiplier: 0.4601 }, { offset: -72600000, multiplier: 0.4608 }, { offset: -72000000, multiplier: 0.4624 }, { offset: -71400000, multiplier: 0.4645 }, { offset: -70800000, multiplier: 0.4719 },
            { offset: -70200000, multiplier: 0.4800 }, { offset: -69600000, multiplier: 0.4862 }, { offset: -69000000, multiplier: 0.4938 }, { offset: -68400000, multiplier: 0.5033 }, { offset: -67800000, multiplier: 0.5186 }, { offset: -67200000, multiplier: 0.5360 }, { offset: -66600000, multiplier: 0.5401 }, { offset: -66000000, multiplier: 0.5367 }, { offset: -65400000, multiplier: 0.5424 }, { offset: -64800000, multiplier: 0.5524 }, { offset: -64200000, multiplier: 0.5574 }, { offset: -63600000, multiplier: 0.5659 }, { offset: -63000000, multiplier: 0.5824 }, { offset: -62400000, multiplier: 0.5960 },
            { offset: -61800000, multiplier: 0.6067 }, { offset: -61200000, multiplier: 0.6186 }, { offset: -60600000, multiplier: 0.6273 }, { offset: -60000000, multiplier: 0.6385 }, { offset: -59400000, multiplier: 0.6475 }, { offset: -58800000, multiplier: 0.6622 }, { offset: -58200000, multiplier: 0.6775 }, { offset: -57600000, multiplier: 0.6970 }, { offset: -57000000, multiplier: 0.7196 }, { offset: -56400000, multiplier: 0.7473 }, { offset: -55800000, multiplier: 0.7674 }, { offset: -55200000, multiplier: 0.7516 }, { offset: -54600000, multiplier: 0.7390 }, { offset: -54000000, multiplier: 0.7470 },
            { offset: -53400000, multiplier: 0.7548 }, { offset: -52800000, multiplier: 0.7636 }, { offset: -52200000, multiplier: 0.7686 }, { offset: -51600000, multiplier: 0.7811 }, { offset: -51000000, multiplier: 0.7932 }, { offset: -50400000, multiplier: 0.7997 }, { offset: -49800000, multiplier: 0.8030 }, { offset: -49200000, multiplier: 0.8068 }, { offset: -48600000, multiplier: 0.8124 }, { offset: -48000000, multiplier: 0.8228 }, { offset: -47400000, multiplier: 0.8242 }, { offset: -46800000, multiplier: 0.8324 }, { offset: -46200000, multiplier: 0.8354 }, { offset: -45600000, multiplier: 0.8447 },
            { offset: -45000000, multiplier: 0.8524 }, { offset: -44400000, multiplier: 0.8657 }, { offset: -43800000, multiplier: 0.8804 }, { offset: -43200000, multiplier: 0.8878 }, { offset: -42600000, multiplier: 0.8931 }, { offset: -42000000, multiplier: 0.8890 }, { offset: -41400000, multiplier: 0.8953 }, { offset: -40800000, multiplier: 0.9001 }, { offset: -40200000, multiplier: 0.9056 }, { offset: -39600000, multiplier: 0.9221 }, { offset: -39000000, multiplier: 0.9613 }, { offset: -38400000, multiplier: 0.9889 }, { offset: -37800000, multiplier: 0.9436 }, { offset: -37200000, multiplier: 0.9254 },
            { offset: -36600000, multiplier: 0.9166 }, { offset: -36000000, multiplier: 0.9099 }, { offset: -35400000, multiplier: 0.9111 }, { offset: -34800000, multiplier: 0.9149 }, { offset: -34200000, multiplier: 0.9237 }, { offset: -33600000, multiplier: 0.9304 }, { offset: -33000000, multiplier: 0.9389 }, { offset: -32400000, multiplier: 0.9452 }, { offset: -31800000, multiplier: 0.9413 }, { offset: -31200000, multiplier: 0.9348 }, { offset: -30600000, multiplier: 0.9405 }, { offset: -30000000, multiplier: 0.9431 }, { offset: -29400000, multiplier: 0.9472 }, { offset: -28800000, multiplier: 0.9575 },
            { offset: -28200000, multiplier: 0.9701 }, { offset: -27600000, multiplier: 0.9995 }, { offset: -27000000, multiplier: 0.9859 }, { offset: -26400000, multiplier: 0.9664 }, { offset: -25800000, multiplier: 0.9622 }, { offset: -25200000, multiplier: 0.9658 }, { offset: -24600000, multiplier: 0.9754 }, { offset: -24000000, multiplier: 0.9723 }, { offset: -23400000, multiplier: 0.9765 }, { offset: -22800000, multiplier: 0.9822 }, { offset: -22200000, multiplier: 0.9912 }, { offset: -21600000, multiplier: 1.0007 }, { offset: -21000000, multiplier: 1.0506 }, { offset: -20400000, multiplier: 1.1350 },
            { offset: -19800000, multiplier: 1.1118 }, { offset: -19200000, multiplier: 1.1215 }, { offset: -18600000, multiplier: 1.1830 }, { offset: -18000000, multiplier: 1.2370 }, { offset: -17400000, multiplier: 1.5589 }, { offset: -16800000, multiplier: 1.3952 }, { offset: -16200000, multiplier: 1.3226 }, { offset: -15600000, multiplier: 1.3108 }, { offset: -15000000, multiplier: 1.3301 }, { offset: -14400000, multiplier: 1.3867 }, { offset: -13800000, multiplier: 1.5482 }, { offset: -13200000, multiplier: 1.7018 }, { offset: -12600000, multiplier: 1.9169 }, { offset: -12000000, multiplier: 2.4124 },
            { offset: -11400000, multiplier: 3.4355 }, { offset: -10800000, multiplier: 6.4407 }, { offset: -10200000, multiplier: 9.7776 }, { offset: -9600000, multiplier: 11.6269 }, { offset: -9000000, multiplier: 12.6715 }, { offset: -8400000, multiplier: 12.9806 }, { offset: -7800000, multiplier: 10.6847 }, { offset: -7200000, multiplier: 6.5559 }, { offset: -6600000, multiplier: 3.5004 }, { offset: -6000000, multiplier: 2.2321 }, { offset: -5400000, multiplier: 1.7360 }, { offset: -4800000, multiplier: 1.4894 }, { offset: -4200000, multiplier: 1.3837 }, { offset: -3600000, multiplier: 1.3449 },
            { offset: -3000000, multiplier: 1.3559 }, { offset: -2400000, multiplier: 1.3603 }, { offset: -1800000, multiplier: 1.3283 }, { offset: -1200000, multiplier: 1.3041 }, { offset: -600000, multiplier: 1.2878 }, { offset: 0, multiplier: 1.2829 }, { offset: 600000, multiplier: 1.2978 }, { offset: 1200000, multiplier: 1.3328 }, { offset: 1800000, multiplier: 1.2926 }, { offset: 2400000, multiplier: 1.2539 }, { offset: 3000000, multiplier: 1.2379 }, { offset: 3600000, multiplier: 1.2280 }, { offset: 4200000, multiplier: 1.2104 }, { offset: 4800000, multiplier: 1.1812 }, { offset: 5400000, multiplier: 1.1685 },
            { offset: 6000000, multiplier: 1.1519 }, { offset: 6600000, multiplier: 1.1278 }, { offset: 7200000, multiplier: 1.1039 }, { offset: 7800000, multiplier: 1.0735 }, { offset: 8400000, multiplier: 1.0369 }, { offset: 9000000, multiplier: 1.0119 }, { offset: 9600000, multiplier: 0.9830 }, { offset: 10200000, multiplier: 0.9549 }, { offset: 10800000, multiplier: 0.9296 }, { offset: 11400000, multiplier: 0.9129 }, { offset: 12000000, multiplier: 0.8935 }, { offset: 12600000, multiplier: 0.8525 }, { offset: 13200000, multiplier: 0.7962 }, { offset: 13800000, multiplier: 0.7599 },
            { offset: 14400000, multiplier: 0.7308 }, { offset: 15000000, multiplier: 0.6979 }, { offset: 15600000, multiplier: 0.6690 }, { offset: 16200000, multiplier: 0.6493 }, { offset: 16800000, multiplier: 0.6273 }, { offset: 17400000, multiplier: 0.6033 }, { offset: 18000000, multiplier: 0.5902 }, { offset: 18600000, multiplier: 0.5742 }, { offset: 19200000, multiplier: 0.5605 }, { offset: 19800000, multiplier: 0.5513 }, { offset: 20400000, multiplier: 0.5420 }, { offset: 21000000, multiplier: 0.5312 }, { offset: 21600000, multiplier: 0.5284 }, { offset: 22200000, multiplier: 0.5222 },
            { offset: 22800000, multiplier: 0.5142 }, { offset: 23400000, multiplier: 0.5097 }, { offset: 24000000, multiplier: 0.5118 }, { offset: 24600000, multiplier: 0.5204 }, { offset: 25200000, multiplier: 0.5074 }, { offset: 25800000, multiplier: 0.4964 }, { offset: 26400000, multiplier: 0.4872 }, { offset: 27000000, multiplier: 0.4881 }, { offset: 27600000, multiplier: 0.4841 }, { offset: 28200000, multiplier: 0.4822 }, { offset: 28800000, multiplier: 0.4872 }, { offset: 29400000, multiplier: 0.4868 }, { offset: 30000000, multiplier: 0.4854 }, { offset: 30600000, multiplier: 0.4857 },
            { offset: 31200000, multiplier: 0.4867 }, { offset: 31800000, multiplier: 0.4871 }, { offset: 32400000, multiplier: 0.4962 }, { offset: 33000000, multiplier: 0.5070 }, { offset: 33600000, multiplier: 0.5167 }, { offset: 34200000, multiplier: 0.5298 }, { offset: 34800000, multiplier: 0.5591 }, { offset: 35400000, multiplier: 0.5994 }, { offset: 36000000, multiplier: 0.5915 }, { offset: 36600000, multiplier: 0.5873 }, { offset: 37200000, multiplier: 0.5925 }, { offset: 37800000, multiplier: 0.6031 }, { offset: 38400000, multiplier: 0.6066 }, { offset: 39000000, multiplier: 0.6136 },
            { offset: 39600000, multiplier: 0.6282 }, { offset: 40200000, multiplier: 0.6375 }, { offset: 40800000, multiplier: 0.6483 }, { offset: 41400000, multiplier: 0.6637 }, { offset: 42000000, multiplier: 0.6754 }, { offset: 42600000, multiplier: 0.6865 }, { offset: 43200000, multiplier: 0.7061 }, { offset: 43800000, multiplier: 0.7246 }, { offset: 44400000, multiplier: 0.7423 }, { offset: 45000000, multiplier: 0.7645 }, { offset: 45600000, multiplier: 0.8012 }, { offset: 46200000, multiplier: 0.8497 }, { offset: 46800000, multiplier: 0.8299 }, { offset: 47400000, multiplier: 0.8175 },
            { offset: 48000000, multiplier: 0.8226 }, { offset: 48600000, multiplier: 0.8291 }, { offset: 49200000, multiplier: 0.8306 }, { offset: 49800000, multiplier: 0.8327 }, { offset: 50400000, multiplier: 0.8419 }, { offset: 51000000, multiplier: 0.8442 }, { offset: 51600000, multiplier: 0.8507 }, { offset: 52200000, multiplier: 0.8521 }, { offset: 52800000, multiplier: 0.8491 }, { offset: 53400000, multiplier: 0.8453 }, { offset: 54000000, multiplier: 0.8533 }, { offset: 54600000, multiplier: 0.8540 }, { offset: 55200000, multiplier: 0.8596 }, { offset: 55800000, multiplier: 0.8690 },
            { offset: 56400000, multiplier: 0.8927 }, { offset: 57000000, multiplier: 0.9284 }, { offset: 57600000, multiplier: 0.8878 }, { offset: 58200000, multiplier: 0.8677 }, { offset: 58800000, multiplier: 0.8624 }, { offset: 59400000, multiplier: 0.8576 }, { offset: 60000000, multiplier: 0.8491 }, { offset: 60600000, multiplier: 0.8443 }, { offset: 61200000, multiplier: 0.8490 }, { offset: 61800000, multiplier: 0.8471 }, { offset: 62400000, multiplier: 0.8454 }, { offset: 63000000, multiplier: 0.8474 }, { offset: 63600000, multiplier: 0.8437 }, { offset: 64200000, multiplier: 0.8406 },
            { offset: 64800000, multiplier: 0.8452 }, { offset: 65400000, multiplier: 0.8432 }, { offset: 66000000, multiplier: 0.8541 }, { offset: 66600000, multiplier: 0.8640 }, { offset: 67200000, multiplier: 0.8873 }, { offset: 67800000, multiplier: 0.9377 }, { offset: 68400000, multiplier: 0.9046 }, { offset: 69000000, multiplier: 0.8774 }, { offset: 69600000, multiplier: 0.8706 }, { offset: 70200000, multiplier: 0.8777 }, { offset: 70800000, multiplier: 0.8994 }, { offset: 71400000, multiplier: 0.8810 }, { offset: 72000000, multiplier: 0.8821 }, { offset: 72600000, multiplier: 0.8809 },
            { offset: 73200000, multiplier: 0.8788 }, { offset: 73800000, multiplier: 0.8917 }, { offset: 74400000, multiplier: 0.9025 }, { offset: 75000000, multiplier: 0.9133 }, { offset: 75600000, multiplier: 0.9289 }, { offset: 76200000, multiplier: 0.9523 }, { offset: 76800000, multiplier: 0.9781 }, { offset: 77400000, multiplier: 1.0141 }, { offset: 78000000, multiplier: 1.0816 }, { offset: 78600000, multiplier: 1.1359 }, { offset: 79200000, multiplier: 1.0873 }, { offset: 79800000, multiplier: 1.0550 }, { offset: 80400000, multiplier: 1.0519 }, { offset: 81000000, multiplier: 1.0529 },
            { offset: 81600000, multiplier: 1.0592 }, { offset: 82200000, multiplier: 1.0601 }, { offset: 82800000, multiplier: 1.0700 }, { offset: 83400000, multiplier: 1.0748 }, { offset: 84000000, multiplier: 1.0826 }, { offset: 84600000, multiplier: 1.0841 }, { offset: 85200000, multiplier: 1.0915 }, { offset: 85800000, multiplier: 1.0954 }, { offset: 86400000, multiplier: 1.1014 }, { offset: 87000000, multiplier: 1.1030 }, { offset: 87600000, multiplier: 1.0963 }, { offset: 88200000, multiplier: 1.1023 }, { offset: 88800000, multiplier: 1.1239 }, { offset: 89400000, multiplier: 1.1747 },
            { offset: 90000000, multiplier: 1.1350 }, { offset: 90600000, multiplier: 1.1162 }, { offset: 91200000, multiplier: 1.1079 }, { offset: 91800000, multiplier: 1.0958 }, { offset: 92400000, multiplier: 1.0823 }, { offset: 93000000, multiplier: 1.0644 }, { offset: 93600000, multiplier: 1.0541 }, { offset: 94200000, multiplier: 1.0448 }, { offset: 94800000, multiplier: 1.0358 }, { offset: 95400000, multiplier: 1.0225 }, { offset: 96000000, multiplier: 1.0082 }, { offset: 96600000, multiplier: 0.9818 }, { offset: 97200000, multiplier: 0.9618 }, { offset: 97800000, multiplier: 0.9335 },
            { offset: 98400000, multiplier: 0.9099 }, { offset: 99000000, multiplier: 0.9025 }, { offset: 99600000, multiplier: 0.9064 }, { offset: 100200000, multiplier: 0.9278 }, { offset: 100800000, multiplier: 0.8655 }, { offset: 101400000, multiplier: 0.8228 }, { offset: 102000000, multiplier: 0.7903 }, { offset: 102600000, multiplier: 0.7661 }, { offset: 103200000, multiplier: 0.7400 }, { offset: 103800000, multiplier: 0.7093 }, { offset: 104400000, multiplier: 0.6909 }, { offset: 105000000, multiplier: 0.6675 }, { offset: 105600000, multiplier: 0.6482 }, { offset: 106200000, multiplier: 0.6294 },
            { offset: 106800000, multiplier: 0.6156 }, { offset: 107400000, multiplier: 0.5968 }, { offset: 108000000, multiplier: 0.5930 }, { offset: 108600000, multiplier: 0.5875 }, { offset: 109200000, multiplier: 0.5852 }, { offset: 109800000, multiplier: 0.5918 }, { offset: 110400000, multiplier: 1.0298 }, { offset: 111000000, multiplier: 1.0000 }
        ];

        Highcharts.setOptions({
            time: {
                useUTC: true
            }
        });

        let fullDailyData = [];
        let fullInterpolatedData10m = [];
        let chart;
        let currentGranularity = '1d';
        let activeChartType = 'ccu';
        let activeChartStyle = 'line';
        let currentProcessedData = [];

        const datasetStartDate = new Date('2025-12-31T00:00:00Z');
        const datasetEndDate = new Date('2030-01-01T00:00:00Z');

        function generateDailyData(startDate, endDate) {
            const data = [];
            let currentTime = new Date(startDate);
            let cumulativePositive = 0;
            let cumulativeNegative = 0;
            const ccuPoints = [
                { date: new Date('2026-01-01'), ccu: 10000 },
                { date: new Date('2027-01-01'), ccu: 8500000 },
                { date: new Date('2028-01-01'), ccu: 7280000 },
                { date: new Date('2029-01-01'), ccu: 5460000 },
                { date: new Date('2030-01-01'), ccu: 4670000 }
            ];
            const ccuTimeline = {};
            for (let i = 0; i < ccuPoints.length - 1; i++) {
                const startPoint = ccuPoints[i];
                const endPoint = ccuPoints[i + 1];
                let currentDate = new Date(startPoint.date);
                const totalDays = (endPoint.date.getTime() - startPoint.date.getTime()) / (1000 * 60 * 60 * 24);
                let dayCount = 0;
                while (currentDate < endPoint.date) {
                    const progress = dayCount / totalDays;
                    let baseCcu;
                    const startYear = startPoint.date.getFullYear();
                    if (startYear === 2026) baseCcu = startPoint.ccu + (endPoint.ccu - startPoint.ccu) * (1 - Math.exp(-progress * 5));
                    else if (startYear === 2027) baseCcu = endPoint.ccu + (startPoint.ccu - endPoint.ccu) * (1 / (1 + Math.exp(10 * progress - 5)));
                    else if (startYear === 2028) baseCcu = startPoint.ccu + (endPoint.ccu - startPoint.ccu) * Math.sin(progress * Math.PI / 2);
                    else baseCcu = startPoint.ccu + (endPoint.ccu - startPoint.ccu) * progress;
                    const noise = (Math.random() - 0.5) * 0.1 * baseCcu;
                    ccuTimeline[currentDate.toISOString().slice(0, 10)] = Math.max(10000, Math.floor(baseCcu + noise));
                    currentDate.setDate(currentDate.getDate() + 1);
                    dayCount++;
                }
            }
            while (currentTime <= endDate) {
                const dateString = currentTime.toISOString().slice(0, 10);
                let baseCcu = ccuTimeline[dateString] || 10000;
                if (currentTime.getDay() === 0 || currentTime.getDay() === 6) baseCcu *= 1.4;
                const ccuPoint = { timestamp: currentTime.getTime(), ccu: Math.floor(baseCcu) };
                const ratingPoint = createRatingDataPoint(currentTime, ccuPoint.ccu);
                cumulativePositive += ratingPoint.positive;
                cumulativeNegative += ratingPoint.negative;
                const cumulativeTotalRatings = cumulativePositive + cumulativeNegative;
                const cumulativePositiveRatio = cumulativeTotalRatings > 0 ? (cumulativePositive / cumulativeTotalRatings) * 100 : 0;
                data.push({ ...ccuPoint, ...ratingPoint, cumulativePositive, cumulativeNegative, ratio: parseFloat(cumulativePositiveRatio.toFixed(2)) });
                currentTime.setDate(currentTime.getDate() + 1);
            }
            return data;
        }
        
        function calculateMovingAverage(data, windowSize = 14) {
            return data.map((d, i, arr) => {
                const start = Math.max(0, i - windowSize + 1);
                const end = i + 1;
                const windowData = arr.slice(start, end);
                const sum = windowData.reduce((acc, curr) => acc + curr.ccu, 0);
                return { ...d, avgCcu: Math.round(sum / windowData.length) };
            });
        }
        
        function recalculateMovingAverageForInterpolatedData(data, dailyWindowSize = 14) {
            const pointsPerDay = (24 * 60) / 10; // 144 points for 10min granularity
            const windowSize = dailyWindowSize * pointsPerDay;
            return data.map((d, i, arr) => {
                const start = Math.max(0, i - windowSize + 1);
                const end = i + 1;
                const windowData = arr.slice(start, end);
                const sum = windowData.reduce((acc, curr) => acc + curr.ccu, 0);
                return { ...d, avgCcu: Math.round(sum / windowData.length) };
            });
        }

        function createRatingDataPoint(date, ccu) {
            const isUpdateDay = date.getDate() === 1;
            let positiveRatingsBoost = isUpdateDay ? ccu * (0.1375 + Math.random() * 0.025) : 0;
            let negativeRatingsBoost = isUpdateDay ? ccu * (0.004 + Math.random() * 0.002) : 0;
            const dailyPositiveBase = ccu * (0.005 + Math.random() * 0.005);
            const dailyNegativeBase = ccu * (0.00008 + Math.random() * 0.00004);
            return { 
                positive: Math.floor(dailyPositiveBase + positiveRatingsBoost), 
                negative: Math.floor(dailyNegativeBase + negativeRatingsBoost) 
            };
        }
        
        function getSpikeMultiplier(targetOffset) {
            const index = UPDATE_SPIKE_PATTERN.findIndex(p => p.offset >= targetOffset);

            if (index === -1 || index === 0) {
                return 1.0;
            }

            const p1 = UPDATE_SPIKE_PATTERN[index - 1];
            const p2 = UPDATE_SPIKE_PATTERN[index];

            const x1 = p1.offset;
            const y1 = p1.multiplier;
            const x2 = p2.offset;
            const y2 = p2.multiplier;

            if (x2 === x1) {
                return y1;
            }
            
            const multiplier = y1 + (targetOffset - x1) * (y2 - y1) / (x2 - x1);
            return multiplier;
        }


        function interpolateData(dailyData) {
            if (dailyData.length <= 1) return dailyData;
            
            const interpolated = [];
            const intervalMs = 10 * 60 * 1000;

            for (let i = 0; i < dailyData.length - 1; i++) {
                const d1 = dailyData[i];
                const d2 = dailyData[i + 1];

                const isUpdateDay = new Date(d1.timestamp).getDate() === 1;
                const updatePeakTime = d1.timestamp + 9 * 3600 * 1000;

                const intervalsForDay = [];
                let tempTimestamp = d1.timestamp;
                while (tempTimestamp < d2.timestamp) {
                    const ratio = (tempTimestamp - d1.timestamp) / (d2.timestamp - d1.timestamp);
                    const dayProgress = ((tempTimestamp - d1.timestamp) % (24 * 3600 * 1000)) / (24 * 3600 * 1000);
                    const diurnalFactor = 0.5 * Math.sin(dayProgress * 2 * Math.PI - Math.PI / 2) + 0.5;
                    const linearCcu = d1.ccu + (d2.ccu - d1.ccu) * ratio;
                    const randomNoise = (Math.random() - 0.5) * 0.1;
                    let baseCcuValue = linearCcu * (0.8 + diurnalFactor * 0.2) + linearCcu * randomNoise;
                    let ccuValue = baseCcuValue;

                    if (isUpdateDay) {
                        const timeOffset = tempTimestamp - updatePeakTime;
                        const spikeMultiplier = getSpikeMultiplier(timeOffset);
                        ccuValue = baseCcuValue * spikeMultiplier;
                    }

                    intervalsForDay.push({ timestamp: tempTimestamp, ccu: Math.max(0, ccuValue) });
                    tempTimestamp += intervalMs;
                }
                
                const totalCcuForDay = intervalsForDay.reduce((sum, interval) => sum + interval.ccu, 0);
                const startCumulativePositive = d1.cumulativePositive - d1.positive;
                const startCumulativeNegative = d1.cumulativeNegative - d1.negative;
                let dayAccumulatedPositive = 0;
                let dayAccumulatedNegative = 0;

                for(const interval of intervalsForDay) {
                    const ccuRatio = totalCcuForDay > 0 ? interval.ccu / totalCcuForDay : 0;
                    const positiveThisInterval = d1.positive * ccuRatio;
                    const negativeThisInterval = d1.negative * ccuRatio;
                    dayAccumulatedPositive += positiveThisInterval;
                    dayAccumulatedNegative += negativeThisInterval;
                    const currentCumulativePositive = startCumulativePositive + dayAccumulatedPositive;
                    const currentCumulativeNegative = startCumulativeNegative + dayAccumulatedNegative;
                    const totalRatings = currentCumulativePositive + currentCumulativeNegative;
                    const currentRatio = totalRatings > 0 ? (currentCumulativePositive / totalRatings) * 100 : 0;

                    interpolated.push({
                        timestamp: interval.timestamp,
                        ccu: Math.floor(interval.ccu),
                        avgCcu: 0,
                        positive: positiveThisInterval,
                        negative: negativeThisInterval,
                        cumulativePositive: currentCumulativePositive,
                        cumulativeNegative: currentCumulativeNegative,
                        ratio: parseFloat(currentRatio.toFixed(2)),
                    });
                }
            }
            if (dailyData.length > 0) {
                 const lastData = dailyData[dailyData.length-1];
                 const existingLast = interpolated.find(p => p.timestamp === lastData.timestamp);
                 if(!existingLast) interpolated.push(lastData);
            }
            return interpolated.map(p => ({ ...p, positive: Math.round(p.positive), negative: Math.round(p.negative), cumulativePositive: Math.round(p.cumulativePositive), cumulativeNegative: Math.round(p.cumulativeNegative) }));
        }
        
        function calculatePercentageChange(data) {
            const initialNulls = { ccuChange: null, avgCcuChange: null, cumulativePositiveChange: null, cumulativeNegativeChange: null, ratioChange: null };
            if (data.length <= 1) return data.map(d => ({ ...d, ...initialNulls }));
            return data.map((d, index) => {
                if (index === 0) return { ...d, ...initialNulls };
                const prevD = data[index - 1];
                const getValue = (val) => (val === null || val === undefined) ? 0 : val;
                const ccuChange = getValue(prevD.ccu) === 0 ? null : ((getValue(d.ccu) - getValue(prevD.ccu)) / getValue(prevD.ccu)) * 100;
                const avgCcuChange = getValue(prevD.avgCcu) === 0 ? null : ((getValue(d.avgCcu) - getValue(prevD.avgCcu)) / getValue(prevD.avgCcu)) * 100;
                const cumulativePositiveChange = getValue(prevD.cumulativePositive) === 0 ? null : ((getValue(d.cumulativePositive) - getValue(prevD.cumulativePositive)) / getValue(prevD.cumulativePositive)) * 100;
                const cumulativeNegativeChange = getValue(prevD.cumulativeNegative) === 0 ? null : ((getValue(d.cumulativeNegative) - getValue(prevD.cumulativeNegative)) / getValue(prevD.cumulativeNegative)) * 100;
                const ratioChange = getValue(prevD.ratio) === 0 ? null : ((getValue(d.ratio) - getValue(prevD.ratio)) / getValue(prevD.ratio)) * 100;
                return { ...d, ccuChange, avgCcuChange, cumulativePositiveChange, cumulativeNegativeChange, ratioChange };
            });
        }

        function renderChart(data) {
            const chartContainer = document.getElementById("highcharts-container");
            if (chart) { chart.destroy(); chart = null; }
            if (!data || data.length === 0) { chartContainer.innerHTML = ""; return; }

            const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches;
            const theme = {
                chart: { backgroundColor: isLightMode ? '#ffffff' : '#2d3748', style: { fontFamily: 'Roboto, sans-serif' }},
                title: { style: { color: isLightMode ? '#333333' : '#e2e8f0' }},
                legend: { itemStyle: { color: isLightMode ? '#333333' : '#e2e8f0' }},
                xAxis: { labels: { style: { color: isLightMode ? '#666666' : '#e2e8f0' }}, title: { style: { color: isLightMode ? '#666666' : '#e2e8f0' }}, lineColor: isLightMode ? '#ccd6eb' : '#4a5568'},
                yAxis: { labels: { style: { color: isLightMode ? '#666666' : '#e2e8f0' }}, title: { style: { color: isLightMode ? '#666666' : '#e2e8f0' }}, gridLineColor: isLightMode ? '#e6e6e6' : '#4a5568'}
            };

            let seriesData, yAxisOptions, title, tooltipFormatter;
            const yAxisFormatter = function() { const val = this.value; if (val >= 1000000) return (val / 1000000).toFixed(1).replace(/\.0$/, '') + 'M'; if (val >= 1000) return (val / 1000).toFixed(1).replace(/\.0$/, '') + 'K'; return val; };
            const getChangeText = (change) => { if (change !== null && isFinite(change)) { const arrow = change >= 0 ? '▲' : '▼'; const color = change >= 0 ? '#10B981' : '#EF4444'; return `<span style="color: ${color}; margin-left: 8px;">${arrow} ${Math.abs(change).toFixed(2)}%</span>`; } return ''; };
            const baseTooltipFormatter = (point, y, seriesName, change) => `<b>${Highcharts.dateFormat('%Y/%m/%d %H:%M', point.x)} (UTC)</b><br/>${seriesName}: ${y.toLocaleString()} ${getChangeText(change)}`;
            const ratioTooltipFormatter = (point, y, seriesName, change) => `<b>${Highcharts.dateFormat('%Y/%m/%d %H:%M', point.x)} (UTC)</b><br/>${seriesName}: ${y.toFixed(2)}% ${getChangeText(change)}`;

            switch (activeChartType) {
                case 'ccu': seriesData = { name: 'CCU', data: data.map(d => [d.timestamp, d.ccu]), color: '#008FFB' }; title = 'CCU'; yAxisOptions = { title: { text: 'ユーザー数' }, labels: { formatter: yAxisFormatter } }; tooltipFormatter = function() { return baseTooltipFormatter(this.points[0], this.y, this.series.name, currentProcessedData[this.points[0].point.index].ccuChange); }; break;
                case 'avg-ccu': seriesData = { name: '平均CCU (14日)', data: data.map(d => [d.timestamp, d.avgCcu]), color: '#00E396' }; title = '14日間平均CCU'; yAxisOptions = { title: { text: 'ユーザー数' }, labels: { formatter: yAxisFormatter } }; tooltipFormatter = function() { return baseTooltipFormatter(this.points[0], this.y, this.series.name, currentProcessedData[this.points[0].point.index].avgCcuChange); }; break;
                case 'cumulative-positive': seriesData = { name: '合計高評価数', data: data.map(d => [d.timestamp, d.cumulativePositive]), color: '#00E396' }; title = '合計高評価数'; yAxisOptions = { title: { text: '合計評価数' }, labels: { formatter: yAxisFormatter } }; tooltipFormatter = function() { return baseTooltipFormatter(this.points[0], this.y, this.series.name, currentProcessedData[this.points[0].point.index].cumulativePositiveChange); }; break;
                case 'cumulative-negative': seriesData = { name: '合計低評価数', data: data.map(d => [d.timestamp, d.cumulativeNegative]), color: '#FF4560' }; title = '合計低評価数'; yAxisOptions = { title: { text: '合計評価数' }, labels: { formatter: yAxisFormatter } }; tooltipFormatter = function() { return baseTooltipFormatter(this.points[0], this.y, this.series.name, currentProcessedData[this.points[0].point.index].cumulativeNegativeChange); }; break;
                case 'ratio': seriesData = { name: '高評価率', data: data.map(d => [d.timestamp, d.ratio]), color: '#FBBF24' }; title = '累積高評価率'; yAxisOptions = { title: { text: '高評価率 (%)' }, labels: { format: '{value:.1f}%' } }; tooltipFormatter = function() { return ratioTooltipFormatter(this.points[0], this.y, this.series.name, currentProcessedData[this.points[0].point.index].ratioChange); }; break;
            }
            
            const options = {
                ...theme,
                chart: { ...theme.chart, zoomType: 'x' },
                title: { ...theme.title, text: title },
                plotOptions: { series: { marker: { enabled: false }}},
                series: [{ ...seriesData, type: activeChartStyle }],
                xAxis: { ...theme.xAxis, type: 'datetime' },
                yAxis: { ...theme.yAxis, title: { ...theme.yAxis.title, ...yAxisOptions.title }, labels: { ...theme.yAxis.labels, ...yAxisOptions.labels }},
                tooltip: { shared: true, useHTML: true, formatter: tooltipFormatter, backgroundColor: isLightMode ? '#ffffff' : '#1f2937', borderColor: isLightMode ? '#e5e7eb' : '#374151', style: { color: isLightMode ? '#111827' : '#f9fafb' }},
                exporting: { enabled: true, buttons: { contextButton: { symbolStroke: isLightMode ? '#666666' : '#e2e8f0', theme: { fill: isLightMode ? '#ffffff' : '#2d3748' }}}},
                credits: { enabled: false }
            };
            chart = Highcharts.chart(chartContainer, options);
        }

        function renderTable(data) {
            const tableBody = document.getElementById('data-table-body');
            tableBody.innerHTML = '';
            if (!data || data.length === 0) { tableBody.innerHTML = `<tr><td colspan="11" class="p-3 text-center text-gray-500">表示するデータがありません。</td></tr>`; return; }
            const reversedData = [...data].reverse();
            reversedData.forEach((d, index) => {
                const row = document.createElement('tr');
                row.className = `transition-colors duration-200 ${index % 2 === 1 ? 'table-row-odd' : 'hover:bg-gray-700 light:hover:bg-gray-100'}`;
                const date = new Date(d.timestamp);
                let dateString = `${date.getUTCFullYear()}/${(date.getUTCMonth() + 1).toString().padStart(2, '0')}/${date.getUTCDate().toString().padStart(2, '0')}`;
                // 1日より細かい粒度の場合のみ時刻を表示
                if (['10m', '30m', '1h'].includes(currentGranularity)) {
                     dateString += ` ${date.getUTCHours().toString().padStart(2, '0')}:${date.getUTCMinutes().toString().padStart(2, '0')}`;
                }
                const formatChange = (change) => { if (change === null || !isFinite(change)) return '-'; const colorClass = change >= 0 ? 'text-green-400' : 'text-red-400'; return `<span class="${colorClass}">${change >= 0 ? '▲' : '▼'} ${Math.abs(change).toFixed(2)}%</span>`; };
                row.innerHTML = `<td class="p-3 text-sm">${dateString}</td> <td class="p-3 text-sm">${(d.ccu || 0).toLocaleString()}</td> <td class="p-3 text-sm">${formatChange(d.ccuChange)}</td> <td class="p-3 text-sm">${(d.avgCcu || 0).toLocaleString()}</td> <td class="p-3 text-sm">${formatChange(d.avgCcuChange)}</td> <td class="p-3 text-sm">${(d.cumulativePositive || 0).toLocaleString()}</td> <td class="p-3 text-sm">${formatChange(d.cumulativePositiveChange)}</td> <td class="p-3 text-sm">${(d.cumulativeNegative || 0).toLocaleString()}</td> <td class="p-3 text-sm">${formatChange(d.cumulativeNegativeChange)}</td> <td class="p-3 text-sm">${(d.ratio || 0).toFixed(2)}%</td> <td class="p-3 text-sm">${formatChange(d.ratioChange)}</td>`;
                tableBody.appendChild(row);
            });
        }

        function updateCounters(data) {
            const counters = { 'ccu-counter': '0', 'avg-ccu-counter': '0', 'positive-counter': '0', 'negative-counter': '0', 'positive-ratio-counter': '0%', 'peak-ccu-counter': '0' };
            if (data && data.length > 0) {
                const latestData = data[data.length - 1];
                counters['ccu-counter'] = (latestData.ccu || 0).toLocaleString();
                counters['avg-ccu-counter'] = (latestData.avgCcu || 0).toLocaleString();
                counters['positive-counter'] = (latestData.cumulativePositive || 0).toLocaleString();
                counters['negative-counter'] = (latestData.cumulativeNegative || 0).toLocaleString();
                counters['positive-ratio-counter'] = `${(latestData.ratio || 0).toFixed(2)}%`;
                counters['peak-ccu-counter'] = data.reduce((max, current) => Math.max(max, current.ccu), 0).toLocaleString();
            }
            for (const id in counters) { document.getElementById(id).textContent = counters[id]; }
        }

        function updateUI() {
            const startDate = new Date(document.getElementById('start-date-picker').value);
            const endDate = new Date(document.getElementById('end-date-picker').value);
            if (isNaN(startDate.getTime()) || isNaN(endDate.getTime())) return;
            startDate.setUTCHours(0, 0, 0, 0);
            endDate.setUTCHours(23, 59, 59, 999);
            
            let processedData;
            const startTimestamp = startDate.getTime();
            const endTimestamp = endDate.getTime();
            let filteredInterpolatedData = fullInterpolatedData10m.filter(d => d.timestamp >= startTimestamp && d.timestamp <= endTimestamp);

            if (currentGranularity === '1d') {
                processedData = [];
                for (let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 1)) {
                    const dayStart = new Date(d); dayStart.setUTCHours(0, 0, 0, 0);
                    const dayEnd = new Date(d); dayEnd.setUTCHours(23, 59, 59, 999);
                    const dataForDay = filteredInterpolatedData.filter(p => p.timestamp >= dayStart.getTime() && p.timestamp <= dayEnd.getTime());
                    if (dataForDay.length === 0) continue;
                    // --- MODIFIED: Changed representative time from 9:00 to 6:40 UTC ---
                    let representativePoint = dataForDay.find(p => new Date(p.timestamp).getUTCHours() === 6 && new Date(p.timestamp).getUTCMinutes() === 40) || dataForDay[dataForDay.length - 1];
                    processedData.push(representativePoint);
                }
            } else {
                processedData = filteredInterpolatedData.filter(d => {
                    const minutes = new Date(d.timestamp).getUTCMinutes();
                    if (currentGranularity === '10m') return true;
                    if (currentGranularity === '30m') return minutes % 30 === 0;
                    if (currentGranularity === '1h') return minutes === 0;
                    return false;
                });
            }

            currentProcessedData = calculatePercentageChange(processedData);
            renderChart(currentProcessedData);
            renderTable(currentProcessedData);
            updateCounters(currentProcessedData);
        }

        function updateActiveButton(containerSelector, activeIdentifier, datasetKey) {
            document.querySelectorAll(`${containerSelector} button`).forEach(btn => {
                btn.classList.toggle('active-btn', btn.dataset[datasetKey] === activeIdentifier);
                btn.classList.toggle('inactive-btn', btn.dataset[datasetKey] !== activeIdentifier);
            });
        }
        
        document.getElementById('chart-style-buttons').addEventListener('click', (e) => {
            const button = e.target.closest('button');
            if (!button || button.disabled) return;
            activeChartStyle = button.dataset.style;
            updateActiveButton('#chart-style-buttons', activeChartStyle, 'style');
            updateUI();
        });

        document.getElementById('chart-type-buttons').addEventListener('click', (e) => {
            const button = e.target.closest('button');
            if (!button || button.disabled) return;
            activeChartType = button.dataset.chart;
            updateActiveButton('#chart-type-buttons', activeChartType, 'chart');
            updateUI();
        });
        
        document.getElementById('granularity-buttons').addEventListener('click', (e) => {
            const button = e.target.closest('button');
            if (!button || button.disabled) return;
            currentGranularity = button.dataset.granularity;
            updateActiveButton('#granularity-buttons', currentGranularity, 'granularity');
            updateUI();
        });
        
        const startDatePicker = document.getElementById('start-date-picker');
        const endDatePicker = document.getElementById('end-date-picker');

        document.getElementById('date-range-buttons').addEventListener('click', (e) => {
            const button = e.target.closest('button');
            if (!button) return;
            const days = button.dataset.days;
            startDatePicker.disabled = days !== 'custom';
            endDatePicker.disabled = days !== 'custom';
            updateActiveButton('#date-range-buttons', days, 'days');
            if (days === 'custom') return;
            let startDate, endDate = new Date(datasetEndDate);
            if (days === 'all') startDate = new Date(datasetStartDate);
            else { startDate = new Date(datasetEndDate); startDate.setDate(datasetEndDate.getDate() - (parseInt(days, 10) - 1)); }
            startDatePicker.valueAsDate = startDate;
            endDatePicker.valueAsDate = endDate;
            updateUI();
        });

        startDatePicker.addEventListener('change', () => { updateActiveButton('#date-range-buttons', 'custom', 'days'); updateUI(); });
        endDatePicker.addEventListener('change', () => { updateActiveButton('#date-range-buttons', 'custom', 'days'); updateUI(); });
        document.getElementById('redraw-chart-btn').addEventListener('click', () => { if (chart) { chart.destroy(); chart = null; } updateUI(); });

        const dailyData = generateDailyData(datasetStartDate, datasetEndDate);
        fullDailyData = calculateMovingAverage(dailyData);
        let interpolatedData = interpolateData(fullDailyData);
        fullInterpolatedData10m = recalculateMovingAverageForInterpolatedData(interpolatedData);

        document.getElementById('date-range-info').textContent = `データ期間: ${datasetStartDate.toLocaleDateString()} ~ ${datasetEndDate.toLocaleDateString()}`;
        document.querySelector('[data-days="all"]').click();
    });
</script>
</body>
</html>
